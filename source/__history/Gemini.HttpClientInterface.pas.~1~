unit Gemini.HttpClientInterface;

{-------------------------------------------------------------------------------

      Github repository :  https://github.com/MaxiDonkey/DelphiGemini
      Visit the Github repository for the documentation and use examples

 ------------------------------------------------------------------------------}

interface

uses
  System.SysUtils, System.Classes,
  System.Net.HttpClient, System.Net.URLClient,
  System.Net.Mime, System.JSON;

type
  /// <summary>
  /// Interface for configuring HTTP client parameters (timeouts, proxy).
  /// </summary>
  IHttpClientParam = interface
    ['{2EEB0617-0D2C-4A8B-A4F1-4B9B3E8F8A90}']
    procedure SetSendTimeOut(const Value: Integer);
    function GetSendTimeOut: Integer;

    function GetConnectionTimeout: Integer;
    procedure SetConnectionTimeout(const Value: Integer);

    function GetResponseTimeout: Integer;
    procedure SetResponseTimeout(const Value: Integer);

    function GetProxySettings: TProxySettings;
    procedure SetProxySettings(const Value: TProxySettings);

    property SendTimeOut: Integer read GetSendTimeOut write SetSendTimeOut;
    property ConnectionTimeout: Integer read GetConnectionTimeout write SetConnectionTimeout;
    property ResponseTimeout: Integer read GetResponseTimeout write SetResponseTimeout;
    property ProxySettings: TProxySettings read GetProxySettings write SetProxySettings;
  end;

  /// <summary>
  /// Abstraction of the HTTP client used by Gemini.API
  /// </summary>
  IHttpClientAPI = interface(IHttpClientParam)
    ['{C5A6B85A-61A6-4D6B-9A10-8E4CCB2D6D4E}']

    {--- GET }
    function Get(const URL: string; Response: TStringStream; const Headers: TNetHeaders): Integer; overload;
    function Get(const URL: string; const Response: TStream; const Headers: TNetHeaders): Integer; overload;

    {--- DELETE }
    function Delete(const URL: string; Response: TStringStream; const Headers: TNetHeaders): Integer;

    {--- POST (no body) }
    function Post(const URL: string; Response: TStringStream; const Headers: TNetHeaders): Integer; overload;

    {--- POST (multipart) }
    function Post(const URL: string; Body: TMultipartFormData; Response: TStringStream; const Headers: TNetHeaders): Integer; overload;

    {--- POST (JSON + stream callback, text response) }
    function Post(const URL: string; Body: TJSONObject; Response: TStringStream;
      const Headers: TNetHeaders; OnReceiveData: TReceiveDataCallback = nil): Integer; overload;

    {--- POST (JSON + stream callback, binary/stream response) }
    function Post(const URL: string; Body: TJSONObject; Response: TStream;
      const Headers: TNetHeaders; OnReceiveData: TReceiveDataCallback = nil): Integer; overload;

    {--- POST (raw stream body; used by UploadRaw) }
    function Post(const URL: string; Body: TStream; Response: TStringStream; const Headers: TNetHeaders): Integer; overload;

    {--- POST (capture response headers; body optional; response body ignored) }
    function PostHeaders(const URL: string; Body: TJSONObject; const Headers: TNetHeaders;
      out ResponseHeaders: TNetHeaders): Integer;

    {--- PATCH (JSON + optional stream callback) }
    function Patch(const URL: string; Body: TJSONObject; Response: TStringStream;
      const Headers: TNetHeaders; OnReceiveData: TReceiveDataCallback = nil): Integer;
  end;

implementation

end.

