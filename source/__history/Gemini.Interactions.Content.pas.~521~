unit Gemini.Interactions.Content;

{-------------------------------------------------------------------------------

      Github repository :  https://github.com/MaxiDonkey/DelphiGemini
      Visit the Github repository for the documentation and use examples

 ------------------------------------------------------------------------------}

interface

uses
  System.SysUtils, System.JSON,
  REST.JsonReflect, REST.Json.Types,
  Gemini.API.Params, Gemini.API, Gemini.Types, Gemini.Exceptions, Gemini.Types.EnumWire;

type
  TInputParams = class;
  TContentIxParams = class(TJSONParam);

  {$REGION 'Turn'}

  TTurnIxParams = class(TJSONParam)
    /// <summary>
    /// The originator of this turn. Must be user for input or model for model output.
    /// </summary>
    function Role(const Value: TMessageRole): TTurnIxParams;

    /// <summary>
    /// The content of the turn.
    /// </summary>
    function Content(const Value: TArray<TContentIxParams>): TTurnIxParams; overload;

    /// <summary>
    /// The content of the turn.
    /// </summary>
    function Content(const Value: TArray<TInputParams>): TTurnIxParams; overload;
  end;

  {$ENDREGION}

  {$REGION 'TextContent'}

  TAnnotationsIxParams = class(TJSONParam)
    /// <summary>
    /// Start of segment of the response that is attributed to this source.
    /// </summary>
    /// <remarks>
    /// Index indicates the start of the segment, measured in bytes.
    /// </remarks>
    function StartIndex(const Value: Integer): TAnnotationsIxParams;

    /// <summary>
    /// End of the attributed segment, exclusive.
    /// </summary>
    function EndIndex(const Value: Integer): TAnnotationsIxParams;

    /// <summary>
    /// Source attributed for a portion of the text. Could be a URL, title, or other identifier.
    /// </summary>
    function Source(const Value: string): TAnnotationsIxParams;

    class function New: TAnnotationsIxParams;
  end;

  TTextContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "text".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.text): TTextContentIxParams;

    /// <summary>
    /// The text content.
    /// </summary>
    function Text(const Value: string): TTextContentIxParams;

    /// <summary>
    /// Citation information for model-generated content.
    /// </summary>
    function Annotations(const Value: TArray<TAnnotationsIxParams>): TTextContentIxParams;

    class function New(const Text: string): TTextContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'ImageContent'}

  TImageContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "image".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.image): TImageContentIxParams;

    /// <summary>
    /// Base64 encoded image
    /// </summary>
    function Data(const Value: string): TImageContentIxParams;

    /// <summary>
    /// Image from uri
    /// </summary>
    function Uri(const Value: string): TImageContentIxParams;

    /// <summary>
    /// Type mime of the image
    /// </summary>
    /// <remarks>
    /// Only image/png, image/jpeg, image/webp, image/heic, image/heif
    /// </remarks>
    function MimeType(const Value: TImageMimeTypeOption): TImageContentIxParams; overload;

    /// <summary>
    /// Type mime of the image
    /// </summary>
    /// <remarks>
    /// Only image/png, image/jpeg, image/webp, image/heic, image/heif
    /// </remarks>
    function MimeType(const Value: string): TImageContentIxParams; overload;

    /// <summary>
    /// The resolution of the media.
    /// </summary>
    /// <remarks>
    /// Only TMediaResolution.low, TMediaResolution.medium, TMediaResolution.high, TMediaResolution.ultra_high
    /// </remarks>
    function Resolution(const Value: TMediaResolution): TImageContentIxParams; overload;

    /// <summary>
    /// The resolution of the media.
    /// </summary>
    /// <remarks>
    /// Only low, medium, high, ultra_high
    /// </remarks>
    function Resolution(const Value: string): TImageContentIxParams; overload;

    class function New: TImageContentIxParams;

  end;

  {$ENDREGION}

  {$REGION 'AudioContent'}

  TAudioContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "audio".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.audio): TAudioContentIxParams;

    /// <summary>
    /// Base64 encoded audio
    /// </summary>
    function Data(const Value: string): TAudioContentIxParams;

    /// <summary>
    /// Audio from uri
    /// </summary>
    function Uri(const Value: string): TAudioContentIxParams;

    /// <summary>
    /// Type mime of the audio
    /// </summary>
    /// <remarks>
    /// Only audio/wav, audio/mp3, audio/aiff, audio/aac, audio/ogg, audio/flac
    /// </remarks>
    function MimeType(const Value: TAudioMimeTypeOption): TAudioContentIxParams; overload;

    /// <summary>
    /// Type mime of the audio
    /// </summary>
    /// <remarks>
    /// Only audio/wav, audio/mp3, audio/aiff, audio/aac, audio/ogg, audio/flac
    /// </remarks>
    function MimeType(const Value: string): TAudioContentIxParams; overload;

    class function New: TAudioContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'DocumentContent'}

  TDocumentContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "document".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.document): TDocumentContentIxParams;

    /// <summary>
    /// Base64 encoded document
    /// </summary>
    function Data(const Value: string): TDocumentContentIxParams;

    /// <summary>
    /// Document from uri
    /// </summary>
    function Uri(const Value: string): TDocumentContentIxParams;

    /// <summary>
    /// Type mime of the document
    /// </summary>
    /// <remarks>
    /// Only application/pdf
    /// </remarks>
    function MimeType(const Value: TDocumentMimeTypeOption): TDocumentContentIxParams; overload;

    /// <summary>
    /// Type mime of the document
    /// </summary>
    /// <remarks>
    /// Only application/pdf
    /// </remarks>
    function MimeType(const Value: string): TDocumentContentIxParams; overload;

    class function New: TDocumentContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'VideoContent'}

  TVideoContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "video".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.video): TVideoContentIxParams;

    /// <summary>
    /// Base64 encoded video
    /// </summary>
    function Data(const Value: string): TVideoContentIxParams;

    /// <summary>
    /// Video from uri
    /// </summary>
    function Uri(const Value: string): TVideoContentIxParams;

    /// <summary>
    /// Type mime of the video
    /// </summary>
    /// <remarks>
    /// Only video/mp4, video/mpeg, video/mov, video/avi, video/x-flv, video/mpg, video/webm, video/wmv, video/3gpp
    /// </remarks>
    function MimeType(const Value: TVideoMimeTypeOption): TVideoContentIxParams; overload;

    /// <summary>
    /// Type mime of the video
    /// </summary>
    /// <remarks>
    /// Only video/mp4, video/mpeg, video/mov, video/avi, video/x-flv, video/mpg, video/webm, video/wmv, video/3gpp
    /// </remarks>
    function MimeType(const Value: string): TVideoContentIxParams; overload;

    /// <summary>
    /// The resolution of the media.
    /// </summary>
    /// <remarks>
    /// Only TMediaResolution.low, TMediaResolution.medium, TMediaResolution.high, TMediaResolution.ultra_high
    /// </remarks>
    function Resolution(const Value: TMediaResolution): TVideoContentIxParams; overload;

    /// <summary>
    /// The resolution of the media.
    /// </summary>
    /// <remarks>
    /// Only TMediaResolution.low, TMediaResolution.medium, TMediaResolution.high, TMediaResolution.ultra_high
    /// </remarks>
    function Resolution(const Value: string): TVideoContentIxParams; overload;

    class function New: TVideoContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'ThoughtContent'}

  TThoughtSummaryIxParams = class(TJSONParam)
    function &Type(const Value: string = 'text'): TThoughtSummaryIxParams;

    function Text(const Value: string): TThoughtSummaryIxParams;

    class function New(const Text: string): TThoughtSummaryIxParams;
  end;

  TThoughtContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "thought".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.thought): TThoughtContentIxParams;

    /// <summary>
    /// Signature to match the backend source to be part of the generation.
    /// </summary>
    function Signature(const Value: string): TThoughtContentIxParams;

    /// <summary>
    /// A summary of the thought.
    /// </summary>
    function Summary(const Value: TArray<TThoughtSummaryIxParams>): TThoughtContentIxParams;

    class function New: TThoughtContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'FunctionCallContent'}

  TFunctionCallContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "function_call".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.function_call): TFunctionCallContentIxParams;

    /// <summary>
    /// Required: The name of the tool to call.
    /// </summary>
    function Name(const Value: string): TFunctionCallContentIxParams;

    /// <summary>
    /// Required: The arguments to pass to the function.
    /// </summary>
    function Arguments(const Value: TJSONObject): TFunctionCallContentIxParams; overload;

    /// <summary>
    /// Required: The arguments to pass to the function.
    /// </summary>
    function Arguments(const Value: string): TFunctionCallContentIxParams; overload;

    /// <summary>
    /// Required: A unique ID for this specific tool call.
    /// </summary>
    function Id(const Value: string): TFunctionCallContentIxParams;

    class function New: TFunctionCallContentIxParams; overload;
    class function New(const Name, Id: string; const Arguments: TJSONObject): TFunctionCallContentIxParams; overload;
    class function New(const Name, Id: string; const Arguments: string): TFunctionCallContentIxParams; overload;
  end;

  {$ENDREGION}

  {$REGION 'FunctionResultContent'}

  TFunctionResultContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "function_result".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.function_result): TFunctionResultContentIxParams;

    /// <summary>
    /// The name of the tool that was called.
    /// </summary>
    function Name(const Value: string): TFunctionResultContentIxParams;

    /// <summary>
    /// Whether the tool call resulted in an error.
    /// </summary>
    function IsError(const Value: Boolean): TFunctionResultContentIxParams;

    /// <summary>
    /// Required: The result of the tool call.
    /// </summary>
    function Result(const Value: string): TFunctionResultContentIxParams; overload;

    /// <summary>
    /// Required: The result of the tool call.
    /// </summary>
    function Result(const Value: TJSONObject): TFunctionResultContentIxParams; overload;

    /// <summary>
    /// Required: The result of the tool call.
    /// </summary>
    function ResultText(const Value: string): TFunctionResultContentIxParams;

    /// <summary>
    /// Required: ID to match the ID from the function call block.
    /// </summary>
    function CallId(const Value: string): TFunctionResultContentIxParams;

    class function New: TFunctionResultContentIxParams; overload;
    class function New(const AResult: string; const CallId: string): TFunctionResultContentIxParams; overload;
    class function New(const AResult: TJSONObject; const CallId: string): TFunctionResultContentIxParams; overload;
  end;

  {$ENDREGION}

  {$REGION 'CodeExecutionCallContent'}

  TCodeExecutionCallArgumentsIxParams = class(TJSONParam)
    /// <summary>
    /// Programming language of the `code`.
    /// </summary>
    function Language(const Value: TLanguageType): TCodeExecutionCallArgumentsIxParams;

    /// <summary>
    /// The code to be executed.
    /// </summary>
    function Code(const Value: string): TCodeExecutionCallArgumentsIxParams;

    class function New: TCodeExecutionCallArgumentsIxParams;
  end;

  TCodeExecutionCallContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "code_execution_call".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.code_execution_call): TCodeExecutionCallContentIxParams;

    /// <summary>
    /// The arguments to pass to the code execution.
    /// </summary>
    function Arguments(const Value: TCodeExecutionCallArgumentsIxParams): TCodeExecutionCallContentIxParams; overload;

    /// <summary>
    /// The arguments to pass to the code execution.
    /// </summary>
    function Arguments(const Value: TJSONObject): TCodeExecutionCallContentIxParams; overload;

    /// <summary>
    /// The arguments to pass to the code execution.
    /// </summary>
    function Arguments(const Value: string): TCodeExecutionCallContentIxParams; overload;

    /// <summary>
    /// A unique ID for this specific tool call.
    /// </summary>
    function Id(const Value: string): TCodeExecutionCallContentIxParams;

    class function New: TCodeExecutionCallContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'CodeExecutionResultContent'}

  TCodeExecutionResultContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "code_execution_result".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.code_execution_result): TCodeExecutionResultContentIxParams;

    /// <summary>
    /// The output of the code execution.
    /// </summary>
    function Result(const Value: string): TCodeExecutionResultContentIxParams;

    /// <summary>
    /// Whether the code execution resulted in an error.
    /// </summary>
    function IsError(const Value: Boolean): TCodeExecutionResultContentIxParams;

    /// <summary>
    /// A signature hash for backend validation.
    /// </summary>
    function Signature(const Value: string): TCodeExecutionResultContentIxParams;

    /// <summary>
    /// ID to match the ID from the code execution call block.
    /// </summary>
    function CallId(const Value: string): TCodeExecutionResultContentIxParams;

    class function New: TCodeExecutionResultContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'UrlContextCallContent'}

  TUrlContextCallArgumentsIxParams = class(TJSONParam)
    /// <summary>
    /// The URLs to fetch.
    /// </summary>
    function Urls(const Value: TArray<string>): TUrlContextCallArgumentsIxParams;

    class function New(const Value: TArray<string>): TUrlContextCallArgumentsIxParams;
  end;

  TUrlContextCallContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "url_context_call".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.url_context_call): TUrlContextCallContentIxParams;

    /// <summary>
    /// The arguments to pass to the URL context.
    /// </summary>
    function Arguments(const Value: TUrlContextCallArgumentsIxParams): TUrlContextCallContentIxParams; overload;

    /// <summary>
    /// The arguments to pass to the URL context.
    /// </summary>
    function Arguments(const Value: TJSONObject): TUrlContextCallContentIxParams; overload;

    /// <summary>
    /// The arguments to pass to the URL context.
    /// </summary>
    function Arguments(const Value: string): TUrlContextCallContentIxParams; overload;

    /// <summary>
    /// A unique ID for this specific tool call.
    /// </summary>
    function Id(const Value: string): TUrlContextCallContentIxParams;

    class function New: TUrlContextCallContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'UrlContextResultContent'}

  TUrlContextResultIxParams = class(TJSONParam)
    /// <summary>
    /// The URL that was fetched.
    /// </summary>
    function Url(const Value: string): TUrlContextResultIxParams;

    /// <summary>
    /// The status of the URL retrieval.
    /// </summary>
    function Status(const Value: TUrlStatus): TUrlContextResultIxParams;

    class function New: TUrlContextResultIxParams;
  end;

  TUrlContextResultContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "url_context_result".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.url_context_result): TUrlContextResultContentIxParams;

    /// <summary>
    /// The results of the URL context.
    /// </summary>
    function Result(const Value: TArray<TUrlContextResultIxParams>): TUrlContextResultContentIxParams;

    /// <summary>
    /// Whether the URL context resulted in an error.
    /// </summary>
    function IsError(const Value: Boolean): TUrlContextResultContentIxParams;

    /// <summary>
    /// ID to match the ID from the url context call block.
    /// </summary>
    function CallId(const Value: string): TUrlContextResultContentIxParams;

    class function New: TUrlContextResultContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'GoogleSearchCallContent'}

  TGoogleSearchCallArgumentsIxParams = class(TJSONParam)
    /// <summary>
    /// Web search queries for the following-up web search.
    /// </summary>
    function Queries(const Value: TArray<string>): TGoogleSearchCallArgumentsIxParams;

    class function NewQueries(const Value: TArray<string>): TGoogleSearchCallArgumentsIxParams;
  end;

  TGoogleSearchCallContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "google_search_call".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.google_search_call): TGoogleSearchCallContentIxParams;

    /// <summary>
    /// The arguments to pass to Google Search.
    /// </summary>
    function Arguments(const Value: TGoogleSearchCallArgumentsIxParams): TGoogleSearchCallContentIxParams; overload;

    /// <summary>
    /// The arguments to pass to Google Search.
    /// </summary>
    function Arguments(const Value: TJSONObject): TGoogleSearchCallContentIxParams; overload;

    /// <summary>
    /// The arguments to pass to Google Search.
    /// </summary>
    function Arguments(const Value: string): TGoogleSearchCallContentIxParams; overload;

    /// <summary>
    /// A unique ID for this specific tool call.
    /// </summary>
    function Id(const Value: string): TGoogleSearchCallContentIxParams;

    class function New: TGoogleSearchCallContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'GoogleSearchResultContent'}

  TGoogleSearchResultIxParams = class(TJSONParam)
    /// <summary>
    /// URI reference of the search result.
    /// </summary>
    function Url(const Value: string): TGoogleSearchResultIxParams;

    /// <summary>
    /// Title of the search result.
    /// </summary>
    function Title(const Value: string): TGoogleSearchResultIxParams;

    /// <summary>
    /// Web content snippet that can be embedded in a web page or an app webview.
    /// </summary>
    function RenderedContent(const Value: string): TGoogleSearchResultIxParams;

    class function New: TGoogleSearchResultIxParams;
  end;

  TGoogleSearchResultContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "google_search_result".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.google_search_result): TGoogleSearchResultContentIxParams;

    /// <summary>
    /// The signature of the Google Search result.
    /// </summary>
    function Signature(const Value: string): TGoogleSearchResultContentIxParams;

    /// <summary>
    /// The results of the Google Search.
    /// </summary>
    function Result(const Value: TArray<TGoogleSearchResultIxParams>): TGoogleSearchResultContentIxParams;

    /// <summary>
    /// Whether the Google Search resulted in an error.
    /// </summary>
    function IsError(const Value: Boolean): TGoogleSearchResultContentIxParams;

    /// <summary>
    /// ID to match the ID from the google search call block.
    /// </summary>
    function CallId(const Value: string): TGoogleSearchResultContentIxParams;

    class function New: TGoogleSearchResultContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'McpServerToolCallContent'}

  TMcpServerToolCallContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "mcp_server_tool_call".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.mcp_server_tool_call): TMcpServerToolCallContentIxParams;

    /// <summary>
    /// Required: The name of the tool which was called.
    /// </summary>
    function Name(const Value: string): TMcpServerToolCallContentIxParams;

    /// <summary>
    /// Required: The name of the used MCP server.
    /// </summary>
    function ServerName(const Value: string): TMcpServerToolCallContentIxParams;

    /// <summary>
    /// Required: The JSON object of arguments for the function.
    /// </summary>
    function Arguments(const Value: TJSONObject): TMcpServerToolCallContentIxParams; overload;

    /// <summary>
    /// Required: The JSON object of arguments for the function.
    /// </summary>
    function Arguments(const Value: string): TMcpServerToolCallContentIxParams; overload;

    /// <summary>
    /// Required: A unique ID for this specific tool call.
    /// </summary>
    function Id(const Value: string): TMcpServerToolCallContentIxParams;

    class function New: TMcpServerToolCallContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'McpServerToolResultContent'}

  TMcpServerToolResultContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "mcp_server_tool_result".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.mcp_server_tool_result): TMcpServerToolResultContentIxParams;

    /// <summary>
    /// Name of the tool which is called for this specific tool call.
    /// </summary>
    function Name(const Value: string): TMcpServerToolResultContentIxParams;

    /// <summary>
    /// The name of the used MCP server.
    /// </summary>
    function ServerName(const Value: string): TMcpServerToolResultContentIxParams;

    /// <summary>
    /// Required: The result of the tool call.
    /// </summary>
    function Result(const Value: TJSONObject): TMcpServerToolResultContentIxParams; overload;

    /// <summary>
    /// Required: The result of the tool call.
    /// </summary>
    function Result(const Value: string): TMcpServerToolResultContentIxParams; overload;

    /// <summary>
    /// Required: ID to match the ID from the MCP server tool call block.
    /// </summary>
    function CallId(const Value: string): TMcpServerToolResultContentIxParams;

    class function New: TMcpServerToolResultContentIxParams;
  end;

  {$ENDREGION}

  {$REGION 'FileSearchResultContent'}

  TFileSearchResultIxParams = class(TJSONParam)
    /// <summary>
    /// The title of the search result.
    /// </summary>
    function Title(const Value: string): TFileSearchResultIxParams;

    /// <summary>
    /// The text of the search result.
    /// </summary>
    function Text(const Value: string): TFileSearchResultIxParams;

    /// <summary>
    /// The name of the file search store.
    /// </summary>
    function FileSearchStore(const Value: string): TFileSearchResultIxParams;

    class function New: TFileSearchResultIxParams; overload;
    class function New(const Text: string): TFileSearchResultIxParams; overload;
    class function New(const Text, Store: string): TFileSearchResultIxParams; overload;
    class function New(const Title, Text, Store: string): TFileSearchResultIxParams; overload;
  end;

  TFileSearchResultContentIxParams = class(TContentIxParams)
    /// <summary>
    /// Always set to "file_search_result".
    /// </summary>
    function &Type(const Value: TContentType = TContentType.file_search_result): TFileSearchResultContentIxParams;

    /// <summary>
    /// The results of the File Search.
    /// </summary>
    function Result(const Value: TArray<TFileSearchResultIxParams>): TFileSearchResultContentIxParams;

    class function New: TFileSearchResultContentIxParams;
  end;

  {$ENDREGION}

  TInputParams = class(TJSONParam)
    class function AddText(const Value: string): TInputParams;

    class function AddAudio(const Data64: string; const MimeType: string): TInputParams; overload;
    class function AddAudio(const Uri: string): TInputParams; overload;
    class function AddAudio(const Value: TAudioContentIxParams): TInputParams; overload;

    class function AddDocument(const Data64: string; const MimeType: string): TInputParams; overload;
    class function AddDocument(const Uri: string): TInputParams; overload;
    class function AddDocument(const Value: TDocumentContentIxParams): TInputParams; overload;

    class function AddImage(const Data64: string; const MimeType: string): TInputParams; overload;
    class function AddImage(const Uri: string): TInputParams; overload;
    class function AddImage(const Value: TImageContentIxParams): TInputParams; overload;

    class function AddVideo(const Data64: string; const MimeType: string): TInputParams; overload;
    class function AddVideo(const Uri: string): TInputParams; overload;
    class function AddVideo(const Value: TVideoContentIxParams): TInputParams; overload;

    class function AddFunctionCall(const Name, Id: string; const Arguments: TJSONObject): TInputParams; overload;
    class function AddFunctionCall(const Name, Id: string; const Arguments: string): TInputParams; overload;

    class function AddFunctionResult(const AResult: string; const CallId: string): TInputParams; overload;
    class function AddFunctionResult(const AResult: TJSONObject; const CallId: string): TInputParams; overload;

    class function AddFileSearchResult(const Value: TFileSearchResultContentIxParams): TInputParams; overload;
    class function AddFileSearchResult(const AResult: TArray<TFileSearchResultIxParams>): TInputParams; overload;

    class function AddRaw(const Value: TContentIxParams): TInputParams;
  end;

  TTurnParams = class(TJSONParam)
    class function AddRole(const Role: TMessageRole; const Value: string): TTurnParams; overload;
    class function AddRole(const Role: TMessageRole; const Content: TArray<TInputParams>): TTurnParams; overload;

    class function AddUser(const Value: string): TTurnParams; overload;
    class function AddUser(const Content: TArray<TInputParams>): TTurnParams; overload;
    class function AddAssistant(const Value: string): TTurnParams;
  end;

 implementation

{$REGION 'Dev note'}

(*

  This unit contains the low-level, JSON-oriented builders used to construct the
  "input" payload for the /interactions endpoint. The goal is to provide a
  stable, fluent API to build OpenAPI "Content" objects (discriminated by the
  "type" field) without forcing callers to manually craft JSON.

  Design principles
  -----------------
  - Spec-first: each *ContentIxParams class mirrors a corresponding Content type
    from the Interactions OpenAPI schema (text, image, audio, document, video,
    function_call, function_result, file_search_result, etc.).
  - Uniform shape: every content builder follows the same pattern:
        New -> Type() -> field setters
    ensuring predictable chaining and consistent generated JSON.
  - Safe JSON handling: when a method accepts JSON as a string (e.g. Arguments(),
    Result()), the string is parsed/validated before being injected into the
    payload to avoid sending malformed JSON.

  Convenience layers
  ------------------
  - TInputParams and TTurnParams are convenience factories:
      * TInputParams wraps individual Content builders into a "ready for input[]"
        element.
      * TTurnParams helps build role-based turns (user/model) that embed content.
    These helpers are not "API endpoints" by themselves; they exist to make it
    easier to author correct payloads and are used by higher-level helper units
    (notably Gemini.Helpers) to provide fluent TArrayBuilder<T> helpers.

  Extensibility / forward compatibility
  -------------------------------------
  - AddRaw(TContentIxParams) is the escape hatch: it allows advanced users (or
    future features) to inject any supported Content type, including ones not
    surfaced as convenience methods, without changing this unit’s public API.

  Practical guidance
  ------------------
  - Use the typed AddXXX helpers (text/image/audio/document/video) for standard
    prompts.
  - Use FunctionCall/FunctionResult and FileSearchResult builders to replay or
    enrich structured contexts (tool traces, retrieval results).
  - Use AddRaw when working with newer or uncommon content types, or when
    replaying server-provided blocks (function results, tool traces, signed content)
    that include signatures or validation fields.

  Example
  -------

  TInteractionParams.Create
      .Input(
        TInput.Create()
          .AddText('hello guy')
          .AddImage('database64', 'image/png')
          .AddImage(TImageContentIxParams.New
              .Data('OtherImage64')
              .MimeType('image/png')
              .Resolution(TMediaResolution.high)
           )
          .AddAudio('AudioBase64', 'audio/wav')
          .AddAudio('https://mon_site/audio.wav')
          .AddDocument('BASE64_ENCODED_DOCUMEN', 'application/pdf')
          .AddDocument('http://my_site/my_doc.pdf')
          .AddVideo('https://www.youtube.com/watch?v=9hE5-98ZeCg')
          .AddFunctionResult('{"weather": "sunny", "temperature": 17}', 'gth23981')
          .AddFileSearchResult(
              TFileSearchResult.Create()
                .AddItem('search result chunk', 'file_search_store')
                .AddItem('My title', 'search result chunk prime', 'file_search_store')
           )
          .AddRaw(
            TFunctionResultContentIxParams.New
              .Name('get_weather')
              .CallId('gth23981') //Here you need to use the callId from the answer provided by Google.
              .Result('{"weather": "sunny", "temperature": 17}')
           )
       )

*)

{$ENDREGION}

{ TTextContentIxParams }

function TTextContentIxParams.&Type(
  const Value: TContentType): TTextContentIxParams;
begin
  Result := TTextContentIxParams(Add('type', Value.ToString));
end;

function TTextContentIxParams.Annotations(
  const Value: TArray<TAnnotationsIxParams>): TTextContentIxParams;
begin
  Result := TTextContentIxParams(Add('annotations',
    TJSONHelper.ToJsonArray<TAnnotationsIxParams>(Value)));
end;

class function TTextContentIxParams.New(const Text: string): TTextContentIxParams;
begin
  Result := TTextContentIxParams.Create.&Type().Text(Text);
end;

function TTextContentIxParams.Text(const Value: string): TTextContentIxParams;
begin
  Result := TTextContentIxParams(Add('text', Value));
end;

{ TAnnotationsIxParams }

function TAnnotationsIxParams.EndIndex(const Value: Integer): TAnnotationsIxParams;
begin
  Result := TAnnotationsIxParams(Add('end_index', Value));
end;

class function TAnnotationsIxParams.New: TAnnotationsIxParams;
begin
  Result := TAnnotationsIxParams.Create;
end;

function TAnnotationsIxParams.Source(const Value: string): TAnnotationsIxParams;
begin
  Result := TAnnotationsIxParams(Add('source', Value));
end;

function TAnnotationsIxParams.StartIndex(
  const Value: Integer): TAnnotationsIxParams;
begin
  Result := TAnnotationsIxParams(Add('start_index', Value));
end;

{ TTurnIxParams }

function TTurnIxParams.Content(const Value: TArray<TContentIxParams>): TTurnIxParams;
begin
  Result := TTurnIxParams(Add('content',
    TJSONHelper.ToJsonArray<TContentIxParams>(Value)));
end;

function TTurnIxParams.Content(
  const Value: TArray<TInputParams>): TTurnIxParams;
begin
  Result := TTurnIxParams(Add('content',
    TJSONHelper.ToJsonArray<TInputParams>(Value)));
end;

function TTurnIxParams.Role(const Value: TMessageRole): TTurnIxParams;
begin
  Result := TTurnIxParams(Add('role', Value.ToString));
end;

{ TImageContentIxParams }

function TImageContentIxParams.Data(const Value: string): TImageContentIxParams;
begin
  Result := TImageContentIxParams(Add('data', Value));
end;

function TImageContentIxParams.MimeType(
  const Value: TImageMimeTypeOption): TImageContentIxParams;
begin
  Result := TImageContentIxParams(Add('mime_type', Value.ToString));
end;

function TImageContentIxParams.MimeType(const Value: string): TImageContentIxParams;
begin
  Result := Self.MimeType(TImageMimeTypeOption.Parse(Value));
end;

class function TImageContentIxParams.New: TImageContentIxParams;
begin
  Result := TImageContentIxParams.Create.&Type();
end;

function TImageContentIxParams.Resolution(
  const Value: string): TImageContentIxParams;
begin
  Result := Self.Resolution(TMediaResolution.Parse(Value));
end;

function TImageContentIxParams.Resolution(
  const Value: TMediaResolution): TImageContentIxParams;
begin
  Result := TImageContentIxParams(Add('resolution', Value.ToString));
end;

function TImageContentIxParams.&Type(
  const Value: TContentType): TImageContentIxParams;
begin
  Result := TImageContentIxParams(Add('type', Value.ToString));
end;

function TImageContentIxParams.Uri(const Value: string): TImageContentIxParams;
begin
  Result := TImageContentIxParams(Add('uri', Value));
end;

{ TAudioContentIxParams }

function TAudioContentIxParams.Data(const Value: string): TAudioContentIxParams;
begin
  Result := TAudioContentIxParams(Add('data', Value));
end;

function TAudioContentIxParams.MimeType(
  const Value: TAudioMimeTypeOption): TAudioContentIxParams;
begin
  Result := TAudioContentIxParams(Add('mime_type', Value.ToString));
end;

function TAudioContentIxParams.MimeType(const Value: string): TAudioContentIxParams;
begin
  Result := Self.MimeType(TAudioMimeTypeOption.Parse(Value));
end;

class function TAudioContentIxParams.New: TAudioContentIxParams;
begin
  Result := TAudioContentIxParams.Create.&Type();
end;

function TAudioContentIxParams.&Type(
  const Value: TContentType): TAudioContentIxParams;
begin
  Result := TAudioContentIxParams(Add('type', Value.ToString));
end;

function TAudioContentIxParams.Uri(const Value: string): TAudioContentIxParams;
begin
  Result := TAudioContentIxParams(Add('uri', Value));
end;

{ TDocumentContentIxParams }

function TDocumentContentIxParams.Data(const Value: string): TDocumentContentIxParams;
begin
  Result := TDocumentContentIxParams(Add('data', Value));
end;

function TDocumentContentIxParams.MimeType(
  const Value: TDocumentMimeTypeOption): TDocumentContentIxParams;
begin
  Result := TDocumentContentIxParams(Add('mime_type', Value.ToString));
end;

function TDocumentContentIxParams.MimeType(const Value: string): TDocumentContentIxParams;
begin
  Result := Self.MimeType(TDocumentMimeTypeOption.Parse(Value));
end;

class function TDocumentContentIxParams.New: TDocumentContentIxParams;
begin
  Result := TDocumentContentIxParams.Create.&Type();
end;

function TDocumentContentIxParams.&Type(const Value: TContentType): TDocumentContentIxParams;
begin
  Result := TDocumentContentIxParams(Add('type', Value.ToString));
end;

function TDocumentContentIxParams.Uri(const Value: string): TDocumentContentIxParams;
begin
  Result := TDocumentContentIxParams(Add('uri', Value));
end;

{ TVideoContentIxParams }

function TVideoContentIxParams.Data(const Value: string): TVideoContentIxParams;
begin
  Result := TVideoContentIxParams(Add('data', Value));
end;

function TVideoContentIxParams.MimeType(
  const Value: TVideoMimeTypeOption): TVideoContentIxParams;
begin
  Result := TVideoContentIxParams(Add('mime_type', Value.ToString));
end;

function TVideoContentIxParams.MimeType(const Value: string): TVideoContentIxParams;
begin
  Result := Self.MimeType(TVideoMimeTypeOption.Parse(Value));
end;

class function TVideoContentIxParams.New: TVideoContentIxParams;
begin
  Result := TVideoContentIxParams.Create.&Type();
end;

function TVideoContentIxParams.Resolution(
  const Value: string): TVideoContentIxParams;
begin
  Result := Self.Resolution(TMediaResolution.Parse(Value));
end;

function TVideoContentIxParams.Resolution(
  const Value: TMediaResolution): TVideoContentIxParams;
begin
  Result := TVideoContentIxParams(Add('resolution', Value.ToString));
end;

function TVideoContentIxParams.&Type(
  const Value: TContentType): TVideoContentIxParams;
begin
  Result := TVideoContentIxParams(Add('type', Value.ToString));
end;

function TVideoContentIxParams.Uri(const Value: string): TVideoContentIxParams;
begin
  Result := TVideoContentIxParams(Add('uri', Value));
end;

{ TThoughtContentIxParams }

class function TThoughtContentIxParams.New: TThoughtContentIxParams;
begin
  Result := TThoughtContentIxParams.Create.&Type();
end;

function TThoughtContentIxParams.Signature(const Value: string): TThoughtContentIxParams;
begin
  Result := TThoughtContentIxParams(Add('signature', Value));
end;

function TThoughtContentIxParams.Summary(const Value: TArray<TThoughtSummaryIxParams>): TThoughtContentIxParams;
begin
  Result := TThoughtContentIxParams(Add('summary',
    TJSONHelper.ToJsonArray<TThoughtSummaryIxParams>(Value)));
end;

function TThoughtContentIxParams.&Type(const Value: TContentType): TThoughtContentIxParams;
begin
  Result := TThoughtContentIxParams(Add('type', Value.ToString));
end;

{ TThoughtSummaryIxParams }

class function TThoughtSummaryIxParams.New(const Text: string): TThoughtSummaryIxParams;
begin
  Result := TThoughtSummaryIxParams.Create.&Type().Text(Text);
end;

function TThoughtSummaryIxParams.Text(const Value: string): TThoughtSummaryIxParams;
begin
  Result := TThoughtSummaryIxParams(Add('text', Value));
end;

function TThoughtSummaryIxParams.&Type(const Value: string): TThoughtSummaryIxParams;
begin
  Result := TThoughtSummaryIxParams(Add('type', Value));
end;

{ TFunctionCallContentIxParams }

function TFunctionCallContentIxParams.Arguments(
  const Value: TJSONObject): TFunctionCallContentIxParams;
begin
  Result := TFunctionCallContentIxParams(Add('arguments', Value));
end;

function TFunctionCallContentIxParams.Arguments(
  const Value: string): TFunctionCallContentIxParams;
var
  JSONObject: TJSONObject;
begin
  if TJSONHelper.TryGetObject(Value, JSONObject) then
    Exit(TFunctionCallContentIxParams(Add('arguments', JSONObject)));

  raise EGeminiException.Create('Invalid JSON Object');
end;

function TFunctionCallContentIxParams.Id(const Value: string): TFunctionCallContentIxParams;
begin
  Result := TFunctionCallContentIxParams(Add('id', Value));
end;

function TFunctionCallContentIxParams.Name(const Value: string): TFunctionCallContentIxParams;
begin
  Result := TFunctionCallContentIxParams(Add('name', Value));
end;

class function TFunctionCallContentIxParams.New(const Name, Id: string;
  const Arguments: TJSONObject): TFunctionCallContentIxParams;
begin
  Result := New
    .Name(Name)
    .Id(Id)
    .Arguments(Arguments);
end;

class function TFunctionCallContentIxParams.New(const Name, Id,
  Arguments: string): TFunctionCallContentIxParams;
begin
  Result := New
    .Name(Name)
    .Id(Id)
    .Arguments(Arguments);
end;

class function TFunctionCallContentIxParams.New: TFunctionCallContentIxParams;
begin
  Result := TFunctionCallContentIxParams.Create.&Type();
end;

function TFunctionCallContentIxParams.&Type(
  const Value: TContentType): TFunctionCallContentIxParams;
begin
  Result := TFunctionCallContentIxParams(Add('type', Value.ToString));
end;

{ TFunctionResultContentIxParams }

function TFunctionResultContentIxParams.CallId(
  const Value: string): TFunctionResultContentIxParams;
begin
  Result := TFunctionResultContentIxParams(Add('call_id', Value));
end;

function TFunctionResultContentIxParams.IsError(
  const Value: Boolean): TFunctionResultContentIxParams;
begin
  Result := TFunctionResultContentIxParams(Add('is_error', Value));
end;

function TFunctionResultContentIxParams.Name(
  const Value: string): TFunctionResultContentIxParams;
begin
  Result := TFunctionResultContentIxParams(Add('name', Value));
end;

class function TFunctionResultContentIxParams.New(const AResult: TJSONObject;
  const CallId: string): TFunctionResultContentIxParams;
begin
  Result := New.Result(AResult).CallId(CallId);
end;

class function TFunctionResultContentIxParams.New(const AResult,
  CallId: string): TFunctionResultContentIxParams;
begin
  Result := New.Result(AResult).CallId(CallId);
end;

class function TFunctionResultContentIxParams.New: TFunctionResultContentIxParams;
begin
  Result := TFunctionResultContentIxParams.Create.&Type();
end;

function TFunctionResultContentIxParams.Result(
  const Value: TJSONObject): TFunctionResultContentIxParams;
begin
  Result := TFunctionResultContentIxParams(Add('result', Value));
end;

function TFunctionResultContentIxParams.ResultText(
  const Value: string): TFunctionResultContentIxParams;
begin
   Result := TFunctionResultContentIxParams(Add('result', Value));
end;

function TFunctionResultContentIxParams.Result(
  const Value: string): TFunctionResultContentIxParams;
var
  JSONObject: TJSONObject;
begin
  if TJSONHelper.TryGetObject(Value, JSONObject) then
    Exit(TFunctionResultContentIxParams(Add('result', JSONObject)));

  raise EGeminiException.Create('Invalid JSON Object');
end;

function TFunctionResultContentIxParams.&Type(
  const Value: TContentType): TFunctionResultContentIxParams;
begin
  Result := TFunctionResultContentIxParams(Add('type', Value.ToString));
end;

{ TCodeExecutionCallContentIxParams }

function TCodeExecutionCallContentIxParams.Arguments(
  const Value: TJSONObject): TCodeExecutionCallContentIxParams;
begin
  Result := TCodeExecutionCallContentIxParams(Add('arguments', Value));
end;

function TCodeExecutionCallContentIxParams.Arguments(
  const Value: TCodeExecutionCallArgumentsIxParams): TCodeExecutionCallContentIxParams;
begin
  Result := Self.Arguments(Value.Detach);
end;

function TCodeExecutionCallContentIxParams.Arguments(
  const Value: string): TCodeExecutionCallContentIxParams;
var
  JSONObject: TJSONObject;
begin
  if TJSONHelper.TryGetObject(Value, JSONObject) then
    Exit(TCodeExecutionCallContentIxParams(Add('arguments', JSONObject)));

  raise EGeminiException.Create('Invalid JSON Object');
end;

function TCodeExecutionCallContentIxParams.Id(
  const Value: string): TCodeExecutionCallContentIxParams;
begin
  Result := TCodeExecutionCallContentIxParams(Add('id', Value));
end;

class function TCodeExecutionCallContentIxParams.New: TCodeExecutionCallContentIxParams;
begin
  Result := TCodeExecutionCallContentIxParams.Create.&Type();
end;

function TCodeExecutionCallContentIxParams.&Type(
  const Value: TContentType): TCodeExecutionCallContentIxParams;
begin
  Result := TCodeExecutionCallContentIxParams(Add('type', Value.ToString));
end;

{ TCodeExecutionCallArgumentsIxParams }

function TCodeExecutionCallArgumentsIxParams.Code(
  const Value: string): TCodeExecutionCallArgumentsIxParams;
begin
  Result := TCodeExecutionCallArgumentsIxParams(Add('code', Value));
end;

function TCodeExecutionCallArgumentsIxParams.Language(
  const Value: TLanguageType): TCodeExecutionCallArgumentsIxParams;
begin
  Result := TCodeExecutionCallArgumentsIxParams(Add('language', Value.ToString));
end;

class function TCodeExecutionCallArgumentsIxParams.New: TCodeExecutionCallArgumentsIxParams;
begin
  Result := TCodeExecutionCallArgumentsIxParams.Create;
end;

{ TCodeExecutionResultContentIxParams }

function TCodeExecutionResultContentIxParams.CallId(
  const Value: string): TCodeExecutionResultContentIxParams;
begin
  Result := TCodeExecutionResultContentIxParams(Add('call_id', Value));
end;

function TCodeExecutionResultContentIxParams.IsError(
  const Value: Boolean): TCodeExecutionResultContentIxParams;
begin
  Result := TCodeExecutionResultContentIxParams(Add('is_error', Value));
end;

class function TCodeExecutionResultContentIxParams.New: TCodeExecutionResultContentIxParams;
begin
  Result := TCodeExecutionResultContentIxParams.Create.&Type();
end;

function TCodeExecutionResultContentIxParams.Result(
  const Value: string): TCodeExecutionResultContentIxParams;
begin
  Result := TCodeExecutionResultContentIxParams(Add('result', Value));
end;

function TCodeExecutionResultContentIxParams.Signature(
  const Value: string): TCodeExecutionResultContentIxParams;
begin
  Result := TCodeExecutionResultContentIxParams(Add('signature', Value));
end;

function TCodeExecutionResultContentIxParams.&Type(
  const Value: TContentType): TCodeExecutionResultContentIxParams;
begin
  Result := TCodeExecutionResultContentIxParams(Add('type', Value.ToString));
end;

{ TUrlContextCallContentIxParams }

function TUrlContextCallContentIxParams.Arguments(
  const Value: TUrlContextCallArgumentsIxParams): TUrlContextCallContentIxParams;
begin
  Result := Self.Arguments(Value.Detach);
end;

function TUrlContextCallContentIxParams.Arguments(
  const Value: TJSONObject): TUrlContextCallContentIxParams;
begin
  Result := TUrlContextCallContentIxParams(Add('arguments', Value));
end;

function TUrlContextCallContentIxParams.Arguments(
  const Value: string): TUrlContextCallContentIxParams;
var
  JSONObject: TJSONObject;
begin
  if TJSONHelper.TryGetObject(Value, JSONObject) then
    Exit(TUrlContextCallContentIxParams(Add('arguments', JSONObject)));

  raise EGeminiException.Create('Invalid JSON Object');
end;

function TUrlContextCallContentIxParams.Id(
  const Value: string): TUrlContextCallContentIxParams;
begin
  Result := TUrlContextCallContentIxParams(Add('id', Value));
end;

class function TUrlContextCallContentIxParams.New: TUrlContextCallContentIxParams;
begin
  Result := TUrlContextCallContentIxParams.Create.&Type();
end;

function TUrlContextCallContentIxParams.&Type(
  const Value: TContentType): TUrlContextCallContentIxParams;
begin
  Result := TUrlContextCallContentIxParams(Add('type', Value.ToString));
end;

{ TUrlContextCallArgumentsIxParams }

class function TUrlContextCallArgumentsIxParams.New(
  const Value: TArray<string>): TUrlContextCallArgumentsIxParams;
begin
  Result := TUrlContextCallArgumentsIxParams.Create.Urls(Value);
end;

function TUrlContextCallArgumentsIxParams.Urls(
  const Value: TArray<string>): TUrlContextCallArgumentsIxParams;
begin
  Result := TUrlContextCallArgumentsIxParams(Add('urls', Value));
end;

{ TUrlContextResultContentIxParams }

function TUrlContextResultContentIxParams.CallId(
  const Value: string): TUrlContextResultContentIxParams;
begin
  Result := TUrlContextResultContentIxParams(Add('call_id', Value));
end;

function TUrlContextResultContentIxParams.IsError(
  const Value: Boolean): TUrlContextResultContentIxParams;
begin
  Result := TUrlContextResultContentIxParams(Add('is_error', Value));
end;

class function TUrlContextResultContentIxParams.New: TUrlContextResultContentIxParams;
begin
  Result := TUrlContextResultContentIxParams.Create.&Type();
end;

function TUrlContextResultContentIxParams.Result(
  const Value: TArray<TUrlContextResultIxParams>): TUrlContextResultContentIxParams;
begin
  Result := TUrlContextResultContentIxParams(Add('result',
    TJSONHelper.ToJsonArray<TUrlContextResultIxParams>(Value)));
end;

function TUrlContextResultContentIxParams.&Type(
  const Value: TContentType): TUrlContextResultContentIxParams;
begin
  Result := TUrlContextResultContentIxParams(Add('type', Value.ToString));
end;

{ TUrlContextResultIxParams }

class function TUrlContextResultIxParams.New: TUrlContextResultIxParams;
begin
  Result := TUrlContextResultIxParams.Create;
end;

function TUrlContextResultIxParams.Status(
  const Value: TUrlStatus): TUrlContextResultIxParams;
begin
  Result := TUrlContextResultIxParams(Add('status', Value.ToString));
end;

function TUrlContextResultIxParams.Url(const Value: string): TUrlContextResultIxParams;
begin
  Result := TUrlContextResultIxParams(Add('url', Value));
end;

{ TGoogleSearchCallContentIxParams }

function TGoogleSearchCallContentIxParams.Arguments(
  const Value: TGoogleSearchCallArgumentsIxParams): TGoogleSearchCallContentIxParams;
begin
  Result := Self.Arguments(Value.Detach);
end;

function TGoogleSearchCallContentIxParams.Arguments(
  const Value: TJSONObject): TGoogleSearchCallContentIxParams;
begin
  Result := TGoogleSearchCallContentIxParams(Add('arguments', Value));
end;

function TGoogleSearchCallContentIxParams.Arguments(
  const Value: string): TGoogleSearchCallContentIxParams;
var
  JSONObject: TJSONObject;
begin
  if TJSONHelper.TryGetObject(Value, JSONObject) then
    Exit(TGoogleSearchCallContentIxParams(Add('arguments', JSONObject)));

  raise EGeminiException.Create('Invalid JSON Object');
end;

function TGoogleSearchCallContentIxParams.Id(
  const Value: string): TGoogleSearchCallContentIxParams;
begin
  Result := TGoogleSearchCallContentIxParams(Add('id', Value));
end;

class function TGoogleSearchCallContentIxParams.New: TGoogleSearchCallContentIxParams;
begin
  Result := TGoogleSearchCallContentIxParams.Create.&Type();
end;

function TGoogleSearchCallContentIxParams.&Type(
  const Value: TContentType): TGoogleSearchCallContentIxParams;
begin
  Result := TGoogleSearchCallContentIxParams(Add('type', Value.ToString));
end;

{ TGoogleSearchCallArgumentsIxParams }

class function TGoogleSearchCallArgumentsIxParams.NewQueries(
  const Value: TArray<string>): TGoogleSearchCallArgumentsIxParams;
begin
  Result := TGoogleSearchCallArgumentsIxParams.Create.Queries(Value);
end;

function TGoogleSearchCallArgumentsIxParams.Queries(
  const Value: TArray<string>): TGoogleSearchCallArgumentsIxParams;
begin
  Result := TGoogleSearchCallArgumentsIxParams(Add('queries', Value));
end;

{ TGoogleSearchResultContentIxParams }

function TGoogleSearchResultContentIxParams.CallId(
  const Value: string): TGoogleSearchResultContentIxParams;
begin
  Result := TGoogleSearchResultContentIxParams(Add('call_id', Value));
end;

function TGoogleSearchResultContentIxParams.IsError(
  const Value: Boolean): TGoogleSearchResultContentIxParams;
begin
  Result := TGoogleSearchResultContentIxParams(Add('is_error', Value));
end;

class function TGoogleSearchResultContentIxParams.New: TGoogleSearchResultContentIxParams;
begin
  Result := TGoogleSearchResultContentIxParams.Create.&Type();
end;

function TGoogleSearchResultContentIxParams.Result(
  const Value: TArray<TGoogleSearchResultIxParams>): TGoogleSearchResultContentIxParams;
begin
  Result := TGoogleSearchResultContentIxParams(Add('result',
    TJSONHelper.ToJsonArray<TGoogleSearchResultIxParams>(Value)));
end;

function TGoogleSearchResultContentIxParams.Signature(
  const Value: string): TGoogleSearchResultContentIxParams;
begin
  Result := TGoogleSearchResultContentIxParams(Add('signature', Value));
end;

function TGoogleSearchResultContentIxParams.&Type(
  const Value: TContentType): TGoogleSearchResultContentIxParams;
begin
  Result := TGoogleSearchResultContentIxParams(Add('type', Value.ToString));
end;

{ TGoogleSearchResultIxParams }

class function TGoogleSearchResultIxParams.New: TGoogleSearchResultIxParams;
begin
  Result := TGoogleSearchResultIxParams.Create;
end;

function TGoogleSearchResultIxParams.RenderedContent(
  const Value: string): TGoogleSearchResultIxParams;
begin
  Result := TGoogleSearchResultIxParams(Add('rendered_content', Value));
end;

function TGoogleSearchResultIxParams.Title(
  const Value: string): TGoogleSearchResultIxParams;
begin
  Result := TGoogleSearchResultIxParams(Add('title', Value));
end;

function TGoogleSearchResultIxParams.Url(
  const Value: string): TGoogleSearchResultIxParams;
begin
  Result := TGoogleSearchResultIxParams(Add('url', Value));
end;

{ TMcpServerToolCallContentIxParams }

function TMcpServerToolCallContentIxParams.Arguments(
  const Value: TJSONObject): TMcpServerToolCallContentIxParams;
begin
  Result := TMcpServerToolCallContentIxParams(Add('arguments', Value));
end;

function TMcpServerToolCallContentIxParams.Arguments(
  const Value: string): TMcpServerToolCallContentIxParams;
var
  JSONObject: TJSONObject;
begin
  if TJSONHelper.TryGetObject(Value, JSONObject) then
    Exit(TMcpServerToolCallContentIxParams(Add('arguments', JSONObject)));

  raise EGeminiException.Create('Invalid JSON Object');
end;

function TMcpServerToolCallContentIxParams.Id(
  const Value: string): TMcpServerToolCallContentIxParams;
begin
  Result := TMcpServerToolCallContentIxParams(Add('id', Value));
end;

function TMcpServerToolCallContentIxParams.Name(
  const Value: string): TMcpServerToolCallContentIxParams;
begin
  Result := TMcpServerToolCallContentIxParams(Add('name', Value));
end;

class function TMcpServerToolCallContentIxParams.New: TMcpServerToolCallContentIxParams;
begin
  Result := TMcpServerToolCallContentIxParams.Create.&Type();
end;

function TMcpServerToolCallContentIxParams.ServerName(
  const Value: string): TMcpServerToolCallContentIxParams;
begin
  Result := TMcpServerToolCallContentIxParams(Add('server_name', Value));
end;

function TMcpServerToolCallContentIxParams.&Type(
  const Value: TContentType): TMcpServerToolCallContentIxParams;
begin
  Result := TMcpServerToolCallContentIxParams(Add('type', Value.ToString));
end;

{ TMcpServerToolResultContentIxParams }

function TMcpServerToolResultContentIxParams.CallId(
  const Value: string): TMcpServerToolResultContentIxParams;
begin
  Result := TMcpServerToolResultContentIxParams(Add('call_id', Value));
end;

function TMcpServerToolResultContentIxParams.Name(
  const Value: string): TMcpServerToolResultContentIxParams;
begin
  Result := TMcpServerToolResultContentIxParams(Add('name', Value));
end;

class function TMcpServerToolResultContentIxParams.New: TMcpServerToolResultContentIxParams;
begin
  Result := TMcpServerToolResultContentIxParams.Create.&Type();
end;

function TMcpServerToolResultContentIxParams.Result(
  const Value: TJSONObject): TMcpServerToolResultContentIxParams;
begin
  Result := TMcpServerToolResultContentIxParams(Add('result', Value));
end;

function TMcpServerToolResultContentIxParams.Result(
  const Value: string): TMcpServerToolResultContentIxParams;
begin
  Result := TMcpServerToolResultContentIxParams(Add('result', Value));
end;

function TMcpServerToolResultContentIxParams.ServerName(
  const Value: string): TMcpServerToolResultContentIxParams;
begin
  Result := TMcpServerToolResultContentIxParams(Add('server_name', Value));
end;

function TMcpServerToolResultContentIxParams.&Type(
  const Value: TContentType): TMcpServerToolResultContentIxParams;
begin
  Result := TMcpServerToolResultContentIxParams(Add('type', Value.ToString));
end;

{ TFileSearchResultContentIxParams }

class function TFileSearchResultContentIxParams.New: TFileSearchResultContentIxParams;
begin
  Result := TFileSearchResultContentIxParams.Create.&Type();
end;

function TFileSearchResultContentIxParams.Result(
  const Value: TArray<TFileSearchResultIxParams>): TFileSearchResultContentIxParams;
begin
  Result := TFileSearchResultContentIxParams(Add('result',
    TJSONHelper.ToJsonArray<TFileSearchResultIxParams>(Value)));
end;

function TFileSearchResultContentIxParams.&Type(
  const Value: TContentType): TFileSearchResultContentIxParams;
begin
  Result := TFileSearchResultContentIxParams(Add('type', Value.ToString));
end;

{ TFileSearchResultIxParams }

function TFileSearchResultIxParams.FileSearchStore(
  const Value: string): TFileSearchResultIxParams;
begin
  Result := TFileSearchResultIxParams(Add('file_search_store', Value));
end;

class function TFileSearchResultIxParams.New: TFileSearchResultIxParams;
begin
  Result := TFileSearchResultIxParams.Create;
end;

class function TFileSearchResultIxParams.New(
  const Text: string): TFileSearchResultIxParams;
begin
  Result := New.Text(Text);
end;

class function TFileSearchResultIxParams.New(const Text,
  Store: string): TFileSearchResultIxParams;
begin
  Result := New(Text).FileSearchStore(Store);
end;

class function TFileSearchResultIxParams.New(const Title, Text,
  Store: string): TFileSearchResultIxParams;
begin
  Result := New(Text, Store).Title(Title);
end;

function TFileSearchResultIxParams.Text(
  const Value: string): TFileSearchResultIxParams;
begin
  Result := TFileSearchResultIxParams(Add('text', Value));
end;

function TFileSearchResultIxParams.Title(
  const Value: string): TFileSearchResultIxParams;
begin
  Result := TFileSearchResultIxParams(Add('title', Value));
end;

{ TTurnParams }

class function TTurnParams.AddAssistant(const Value: string): TTurnParams;
begin
  Result := AddRole(TMessageRole.model, Value);
end;

class function TTurnParams.AddRole(const Role: TMessageRole;
  const Value: string): TTurnParams;
begin
  Result := TTurnParams(
    TTurnIxParams.Create
      .Role(Role)
      .Content([
         TTextContentIxParams.New(Value)
       ])
    );
end;

class function TTurnParams.AddRole(const Role: TMessageRole;
  const Content: TArray<TInputParams>): TTurnParams;
begin
  Result := TTurnParams(
    TTurnIxParams.Create
      .Role(Role)
      .Content(Content)
    );
end;

class function TTurnParams.AddUser(
  const Content: TArray<TInputParams>): TTurnParams;
begin
  Result := AddRole(TMessageRole.user, Content);
end;

class function TTurnParams.AddUser(const Value: string): TTurnParams;
begin
  Result := AddRole(TMessageRole.user, Value);
end;

{ TInputParams }

class function TInputParams.AddAudio(const Uri: string): TInputParams;
begin
  Result := TInputParams(
    TAudioContentIxParams.New
      .Uri(Uri)
  );
end;

class function TInputParams.AddAudio(const Data64,
  MimeType: string): TInputParams;
begin
  Result := TInputParams(
    TAudioContentIxParams.New
      .Data(Data64)
      .MimeType(MimeType)
  );
end;

class function TInputParams.AddAudio(
  const Value: TAudioContentIxParams): TInputParams;
begin
  Result := TInputParams(Value);
end;

class function TInputParams.AddDocument(const Uri: string): TInputParams;
begin
  Result := TInputParams(
    TDocumentContentIxParams.New
      .Uri(Uri)
  );
end;

class function TInputParams.AddDocument(const Data64,
  MimeType: string): TInputParams;
begin
  Result := TInputParams(
    TDocumentContentIxParams.New
      .Data(Data64)
      .MimeType(MimeType)
  );
end;

class function TInputParams.AddDocument(
  const Value: TDocumentContentIxParams): TInputParams;
begin
  Result := TInputParams(Value);
end;

class function TInputParams.AddFileSearchResult(
  const Value: TFileSearchResultContentIxParams): TInputParams;
begin
  Result := TInputParams(Value);
end;

class function TInputParams.AddFileSearchResult(
  const AResult: TArray<TFileSearchResultIxParams>): TInputParams;
begin
  Result := TInputParams(
    TFileSearchResultContentIxParams.New.Result(AResult)
  );
end;

class function TInputParams.AddFunctionCall(const Name, Id,
  Arguments: string): TInputParams;
begin
  Result := TInputParams(
    TFunctionCallContentIxParams.New(Name, Id, Arguments)
  );
end;

class function TInputParams.AddFunctionCall(const Name, Id: string;
  const Arguments: TJSONObject): TInputParams;
begin
  Result := TInputParams(
    TFunctionCallContentIxParams.New(Name, Id, Arguments)
  );
end;

class function TInputParams.AddFunctionResult(const AResult: TJSONObject;
  const CallId: string): TInputParams;
begin
  Result := TInputParams(
    TFunctionResultContentIxParams.New(AResult, CallId)
  );
end;

class function TInputParams.AddFunctionResult(const AResult,
  CallId: string): TInputParams;
begin
  Result := TInputParams(
    TFunctionResultContentIxParams.New(AResult, CallId)
  );
end;

class function TInputParams.AddImage(const Uri: string): TInputParams;
begin
  Result := TInputParams(
    TImageContentIxParams.New
      .Uri(Uri)
  );
end;

class function TInputParams.AddImage(const Data64,
  MimeType: string): TInputParams;
begin
  Result := TInputParams(
    TImageContentIxParams.New
      .Data(Data64)
      .MimeType(MimeType)
  );
end;

class function TInputParams.AddImage(
  const Value: TImageContentIxParams): TInputParams;
begin
  Result := TInputParams(Value);
end;

class function TInputParams.AddRaw(const Value: TContentIxParams): TInputParams;
begin
  Result := TInputParams(Value);
end;

class function TInputParams.AddText(const Value: string): TInputParams;
begin
  Result := TInputParams( TTextContentIxParams.New(Value) );
end;

class function TInputParams.AddVideo(const Data64,
  MimeType: string): TInputParams;
begin
  Result := TInputParams(
    TVideoContentIxParams.New
      .Data(Data64)
      .MimeType(MimeType)
  );
end;

class function TInputParams.AddVideo(const Uri: string): TInputParams;
begin
  Result := TInputParams(
    TVideoContentIxParams.New
      .Uri(Uri)
  );
end;

class function TInputParams.AddVideo(
  const Value: TVideoContentIxParams): TInputParams;
begin
  Result := TInputParams(Value);
end;

end.
